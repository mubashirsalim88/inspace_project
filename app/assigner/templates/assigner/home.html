<!-- app/assigner/templates/assigner/home.html -->
{% extends "base.html" %}
{% block title %}Assigner Dashboard - IN-SPACe{% endblock %}
{% block content %}
<div class="flex min-h-screen bg-gray-100">
    <!-- Sidebar -->
    <aside class="w-64 bg-blue-900 text-white shadow-lg">
        <div class="p-6">
            <h2 class="text-xl font-bold mb-4">Assigner Dashboard</h2>
            <nav>
                <ul class="space-y-2">
                    {% for module in ['module_1', 'module_2', 'module_3', 'module_4', 'module_5', 'module_6', 'module_7', 'module_8'] %}
                    <li>
                        <button class="sidebar-link w-full text-left py-2 px-4 rounded hover:bg-blue-700 transition-colors duration-200 {% if loop.first %}bg-blue-700{% endif %}" data-tab="{{ module }}">{{ module|replace('_', ' ')|title }}</button>
                    </li>
                    {% endfor %}
                </ul>
            </nav>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8">
        <h2 class="text-3xl font-bold text-gray-800 mb-6 animate__animated animate__fadeInDown">Assigner Dashboard</h2>
        <p class="text-gray-600 mb-8">Assign submitted applications to verifiers for review.</p>

        <!-- Module Sections -->
        {% for module in ['module_1', 'module_2', 'module_3', 'module_4', 'module_5', 'module_6', 'module_7', 'module_8'] %}
        <div id="{{ module }}" class="tab-content {% if not loop.first %}hidden{% endif %}">
            <div class="space-y-8">
                <!-- Submitted Applications -->
                <div class="bg-white shadow-lg rounded-lg p-6 border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-4">{{ module|replace('_', ' ')|title }} - Submitted Applications</h3>
                    {% if module_apps[module] %}
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {% for app in module_apps[module] %}
                        <div class="bg-blue-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow duration-300">
                            <h4 class="text-lg font-medium text-gray-900">{{ app.user.name }}</h4>
                            <p class="text-sm text-gray-600">ID: {{ app.id }}</p>
                            <p class="text-sm text-gray-500">Submitted: {{ app.updated_at.strftime('%B %d, %Y') }}</p>
                            <div class="mt-4 flex justify-between items-center">
                                <span class="bg-blue-100 text-blue-700 text-xs font-medium px-3 py-1 rounded-lg">Submitted</span>
                                <a href="{{ url_for('assigner.assign', application_id=app.id) }}" class="text-blue-600 hover:underline text-sm font-semibold">Assign Verifiers</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <p class="text-gray-500 text-center">No submitted {{ module|replace('_', ' ')|title }} applications.</p>
                    {% endif %}
                </div>

                <!-- Assigned Applications -->
                <div class="bg-white shadow-lg rounded-lg p-6 border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-4">{{ module|replace('_', ' ')|title }} - Assigned Applications</h3>
                    {% if assigned_module_apps[module] %}
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        {% for app in assigned_module_apps[module] %}
                        <div class="bg-blue-50 p-4 rounded-lg shadow hover:shadow-md transition-shadow duration-300">
                            <h4 class="text-lg font-medium text-gray-900">{{ app.user.name }}</h4>
                            <p class="text-sm text-gray-600">ID: {{ app.id }}</p>
                            <p class="text-sm text-gray-500">Assigned: {{ app.updated_at.strftime('%B %d, %Y') }}</p>
                            <div class="mt-4 flex justify-between items-center">
                                <span class="bg-green-100 text-green-700 text-xs font-medium px-3 py-1 rounded-lg">Assigned</span>
                                <a href="{{ url_for('assigner.view_assignment', application_id=app.id) }}" class="text-blue-600 hover:underline text-sm font-semibold">View</a>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    {% else %}
                    <p class="text-gray-500 text-center">No assigned {{ module|replace('_', ' ')|title }} applications.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </main>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const sidebarLinks = document.querySelectorAll(".sidebar-link");
    const tabContents = document.querySelectorAll(".tab-content");

    sidebarLinks.forEach(button => {
        button.addEventListener("click", () => {
            const tabId = button.getAttribute("data-tab");
            sidebarLinks.forEach(btn => btn.classList.remove("bg-blue-700"));
            tabContents.forEach(content => content.classList.add("hidden"));
            button.classList.add("bg-blue-700");
            document.getElementById(tabId).classList.remove("hidden");
        });
    });
});
</script>
{% endblock %}